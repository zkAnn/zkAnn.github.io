(function(t){function e(e){for(var o,a,s=e[0],c=e[1],l=e[2],_=0,h=[];_<s.length;_++)a=s[_],n[a]&&h.push(n[a][0]),n[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(h.length)h.shift()();return r.push.apply(r,l||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],o=!0,s=1;s<i.length;s++){var c=i[s];0!==n[c]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=i[0]))}return t}var o={},n={app:0},r=[];function a(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=o,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(i,o,function(e){return t[e]}.bind(null,o));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";var o=i("64a9"),n=i.n(o);n.a},"199c":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es7_object_get_own_property_descriptors__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("8e6e"),core_js_modules_es7_object_get_own_property_descriptors__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es7_object_get_own_property_descriptors__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es6_object_keys__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("456d"),core_js_modules_es6_object_keys__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es6_object_keys__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_array_sort__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("55dd"),core_js_modules_es6_array_sort__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_array_sort__WEBPACK_IMPORTED_MODULE_2__),F_zk_vue_metro_tile_master_node_modules_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("bd86"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("ac6a"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_4__),F_zk_vue_metro_tile_master_node_modules_babel_runtime_corejs2_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("75fc"),_components_MetroTile_vue__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("aa35"),vue_grid_layout__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("7be8"),vue_grid_layout__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(vue_grid_layout__WEBPACK_IMPORTED_MODULE_7__);function ownKeys(t,e){var i=Object.keys(t);return Object.getOwnPropertySymbols&&i.push.apply(i,Object.getOwnPropertySymbols(t)),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(i,!0).forEach(function(e){Object(F_zk_vue_metro_tile_master_node_modules_babel_runtime_corejs2_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__["a"])(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ownKeys(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var BASE_LEN=65,REPO_URL="https://github.com/yuanfux/vue-metro-tile";__webpack_exports__["a"]={name:"app",components:{MetroTile:_components_MetroTile_vue__WEBPACK_IMPORTED_MODULE_6__["a"],VueGridLayout:vue_grid_layout__WEBPACK_IMPORTED_MODULE_7___default.a},data:function(){return{BASE_LEN:BASE_LEN,layout:[],menuStyle:{top:0,left:0,display:"none"},itemSelectIndex:0,menuSelectIndex:0,weekDay:function(){var t={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"};return t[(new Date).getDay()]}(),monthDay:function(){return(new Date).getDate()}(),rotateArray:[90,90,90,90,-90,-90,-90,-90],rotateIndex:0,site:null,interval:null,rotateItemIndex:[]}},mounted:function(){this.getData(),document.oncontextmenu=function(){return!1}},methods:{add:function(){this.itemChange(!0)},remove:function(){this.itemChange(!1)},itemChange:function(t){var e={moduleid:"unit",name:"机构管理",img:"unit.png",icon:"fa fa-home",jsaction:"alert(2)",width:Math.random()<.5?4:2,height:2,"background-color":"#228b22"};if(t)this.layout=this.dataFormat([].concat(Object(F_zk_vue_metro_tile_master_node_modules_babel_runtime_corejs2_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_5__["a"])(this.layout),[e]));else{var i=~~(Math.random()*this.layout.length);this.layout.splice(i,1)}this.saveData(this.layout)},redirect:function(){window.open(REPO_URL,"_blank")},mouseRightClick:function(t,e,i){var o=t.clientX,n=t.clientY,r=document.documentElement.clientWidth||document.body.clientWidth,a=document.documentElement.clientHeight||document.body.clientHeight,s=this.$refs.menu;o=o>=r-s.offsetWidth?r-s.offsetWidth:o,n=n>a-s.offsetHeight?a-s.offsetHeight:n,console.log();var c=-1;2==e.w&&2==e.h?c=1:4==e.w&&4==e.h?c=3:4==e.w&&2==e.h&&(c=2),this.menuSelectIndex=c,this.itemSelectIndex=i,this.menuStyle={left:o+"px",top:n+"px",display:"block"}},menuBlur:function(){this.menuStyle.display="none"},menuClick:function(t){var e=t.target.dataset.type;if(!e||e==this.menuSelectIndex)return this.menuStyle.display="none",!1;var i=[[2,2],[4,2],[4,4]],o=this.itemSelectIndex;if("remove"==e){this.layout.splice(o,1);var n=[];this.layout.forEach(function(t,e){t.item&&n.push(e)}),n.length>0?this.rotateItemIndex=n:this.interval&&clearInterval(this.interval)}else this.layout.splice(o,1,_objectSpread({},this.layout[o],{w:i[e-1][0],h:i[e-1][1]}));this.menuStyle.display="none",this.saveData(this.layout)},onmousedown:function(t){this.site={x:t.pageX,y:t.pageY}},onmouseup:function onmouseup(e,item,index){if(2==e.button)return this.mouseRightClick(e,item,index),!1;var x=this.site.x-e.pageX,y=this.site.y-e.pageY;if(Math.abs(x)+Math.abs(y)>10)return!1;var jsaction=item.jsaction;if(item.item){var type=e.target.dataset.type;jsaction=item.item[type]&&item.item[type].jsaction||""}jsaction&&eval(jsaction)},layoutUpdatedEvent:function(t){this.saveData(t)},getData:function(){var t=this,e=localStorage.getItem("layout");if(e)return this.layout=JSON.parse(e),this.layout.forEach(function(e,i){e.item&&t.rotateItemIndex.push(i)}),this.registerTimer(),!1;this.http.get("https://www.fastmock.site/mock/4cd04d931e195f79858f5993ff4a1c38/metro/api/admin").then(function(e){var i=t.dataFormat(e.data.rows);t.layout=i,t.registerTimer()},function(t){window.console.log("error",t)})},saveData:function(t){localStorage.setItem("layout",JSON.stringify(t))},dataFormat:function(t){var e=this,i=12,o=0,n=0,r=[],a=t.filter(function(t,i){return t.i=t.id&&t.id||~~(1e4*Math.random()+10),t.rotateX=0,t.type=t.item&&(e.rotateItemIndex.push(i),2)||1,void 0===t.x||(r.push(t),!1)});if(r.length>0){var s=r.sort(function(t,e){return e.y-t.y}).filter(function(t){return t.y==r[0].y}).sort(function(t,e){return e.x-t.x})[0];console.log(s),o=s.y,i=12-s.x-s.width,n=s.height,window.console.log(i,o,n)}return a.map(function(t){var e=t.width;return e<=i?(t.height>n&&(n=t.height),t.x=12-i):(o+=n,t.x=0,i=12),i-=e,t.y=o,t.w=t.width,t.h=t.height,t}),t},setRotateX:function(t,e,i){t.rotateX+=i[this[e]%i.length],this[e]+=1},registerTimer:function(){var t=this;this.interval=setInterval(function(){t.rotateItemIndex.forEach(function(e){console.log(e),t.setRotateX(t.layout[e],"rotateIndex",t.rotateArray)})},3e3)}},beforeDestroy:function(){this.interval&&clearInterval(this.interval)}}},"56d7":function(t,e,i){"use strict";i.r(e);i("cadf"),i("551c"),i("f751"),i("097d");var o=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"login"},[i("button",{on:{click:t.add}},[t._v("增加item")]),i("button",{on:{click:t.remove}},[t._v("删除item")])]),t._m(0),i("div",{staticClass:"title"},[t._v("\n    Vue Metro Tile\n  ")]),i("div",{staticClass:"subtitle"},[t._v("\n    *click to animate or drag to rearrange\n  ")]),i("div",{staticClass:"grid-layout-container margin-right"},[i("grid-layout",{attrs:{layout:t.layout,"col-num":12,colWidth:t.BASE_LEN,"row-height":t.BASE_LEN,"is-draggable":!0,"is-resizable":!0,"is-mirrored":!1,"vertical-compact":!0,margin:[0,0],"use-css-transforms":!0},on:{"layout-updated":t.layoutUpdatedEvent}},t._l(t.layout,function(e,o){return i("grid-item",{key:e.i,attrs:{x:e.x,y:e.y,w:e.w,h:e.h,i:e.i}},[i("div",{staticClass:"container",on:{mousedown:function(e){return t.onmousedown(e)},mouseup:function(i){return t.onmouseup(i,e,o)}}},[i("MetroTile",{attrs:{width:e.w*t.BASE_LEN-6,height:e.h*t.BASE_LEN-6,rotateX:e.rotateX,faceStyle:{background:e["background-color"]},"data-type":e.moduleid}},[1==e.type?[i("div",{attrs:{slot:"front"},slot:"front"},[i("img",{staticClass:"icon",attrs:{src:e.img,alt:""}}),e.name?i("div",{staticClass:"tile-label"},[t._v("\n                   "+t._s(e.name)+"\n                  ")]):t._e()])]:2===e.type?[i("div",{style:{height:"100%",background:e.item[0]["background-color"]},attrs:{slot:"front","data-type":"0"},slot:"front"},[i("div",{staticClass:"tile-label"},[t._v("\n                   "+t._s(e.item[0].name)+"\n                  ")])]),i("div",{style:{height:"100%",background:e.item[1]["background-color"]},attrs:{slot:"top","data-type":"1"},slot:"top"},[i("div",{staticClass:"tile-label"},[t._v("\n                     "+t._s(e.item[1].name)+"\n                  ")])]),i("div",{style:{height:"100%",background:e.item[2]["background-color"]},attrs:{slot:"bottom","data-type":"2"},slot:"bottom"},[t._v("\n                   "+t._s(e.item[2].name)+"\n              ")])]:t._e()],2)],1)])}),1)],1),i("div",{ref:"menu",staticClass:"menu",style:t.menuStyle,attrs:{tabindex:"-1"},on:{blur:t.menuBlur,click:function(e){return e.stopPropagation(),t.menuClick(e)}}},[i("div",{staticClass:"menu-item",class:{selected:1==t.menuSelectIndex},attrs:{"data-type":"1"}},[t._v("中")]),i("div",{staticClass:"menu-item",class:{selected:2==t.menuSelectIndex},attrs:{"data-type":"2"}},[t._v("宽")]),i("div",{staticClass:"menu-item",class:{selected:3==t.menuSelectIndex},attrs:{"data-type":"3"}},[t._v("大")]),i("div",{staticClass:"menu-item",attrs:{"data-type":"remove"}},[t._v("删除")])])])},r=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("img",{attrs:{width:"120",height:"120",src:"https://user-images.githubusercontent.com/6414178/45662644-3a441000-bb35-11e8-8e72-e6ed618a733d.png"}})])}],a=i("199c"),s=a["a"],c=(i("034f"),i("2877")),l=Object(c["a"])(s,n,r,!1,null,null,null),u=l.exports,_=i("bc3a"),h=i.n(_);o["default"].config.productionTip=!1,o["default"].prototype.http=h.a,new o["default"]({render:function(t){return t(u)}}).$mount("#app")},"64a9":function(t,e,i){},aa35:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"scene",style:t.sceneStyle,on:{mousemove:function(e){return t.onMouseMove(e)},mousedown:function(e){return t.onMouseDown(e)},mouseup:function(e){return t.onMouseUp(e)},mouseleave:t.onMouseLeave,touchmove:function(e){return e.preventDefault(),t.onTouchMove(e)}}},[i("div",{style:t.boxContainerStyle},[i("div",{style:t.frontFaceStyle},[t._t("front")],2),i("div",{style:t.backFaceStyle},[t._t("back")],2),i("div",{style:t.topFaceStyle},[t._t("top")],2),i("div",{style:t.bottomFaceStyle},[t._t("bottom")],2),i("div",{style:t.rightFaceStyle},[t._t("right")],2),i("div",{style:t.leftFaceStyle},[t._t("left")],2)]),i("div",{class:{border:t.isHover&&!t.isMouseDown},style:t.glareBoundingBox},[i("div",{style:t.hoverGlareStyle}),i("div",{class:{ripple:t.isAnimating},style:t.clickGlareStyle,on:{animationend:t.resetAnimation}})])])},n=[],r=(i("8e6e"),i("ac6a"),i("456d"),i("bd86"));i("c5f6");function a(t,e){var i=Object.keys(t);return Object.getOwnPropertySymbols&&i.push.apply(i,Object.getOwnPropertySymbols(t)),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i}function s(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?a(i,!0).forEach(function(e){Object(r["a"])(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):a(i).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}var c={name:"MetroTile",props:{faceStyle:{type:Object},frontStyle:{type:Object},backStyle:{type:Object},rightStyle:{type:Object},leftStyle:{type:Object},topStyle:{type:Object},bottomStyle:{type:Object},rotateX:{type:Number,default:0},height:{type:Number,default:200},width:{type:Number,default:250},perspective:{type:Number,default:750},maxTiltX:{type:Number,default:20},maxTiltY:{type:Number,default:10},clickGlareSize:{type:Number,default:90},clickGlareOpacity:{type:Number,default:.2},hoverGlareOpacity:{type:Number,default:.3}},data:function(){return{curTiltTransform:"",clickGlareTop:0,clickGlareLeft:0,glareScale:5,hoverX:0,hoverY:0,mouseDownX:0,mouseDownY:0,isHover:!1,isMouseDown:!1,isAnimating:!1}},computed:{sceneStyle:function(){return{position:"relative",cursor:"pointer",width:"".concat(this.width,"px"),height:"".concat(this.height,"px"),perspective:"".concat(this.perspective,"px"),overflow:"hidden","background-color":"rgba(153,153,153,0.3)"}},curFaceTransform:function(){return"translateZ(-".concat(this.height/2,"px) rotateX(").concat(this.rotateX,"deg)")},boxContainerStyle:function(){return{width:"100%",height:"100%",position:"relative","transform-style":"preserve-3d",transition:"transform 0.5s",transform:"".concat(this.curTiltTransform," ").concat(this.curFaceTransform),"will-change":"transform"}},glareBoundingBox:function(){var t=Math.max(this.height/2,this.width/2),e=this.perspective?this.perspective/(this.perspective-t):1;return{width:"100%",height:"100%",top:0,left:0,position:"absolute",overflow:"hidden","transform-style":"preserve-3d",transform:"scale(".concat(1/e,", ").concat(1/e,") translateZ(").concat(t,"px"),"pointer-events":"none"}},hoverGlareStyle:function(){return{position:"absolute",width:"".concat(2*this.width,"px"),height:"".concat(2*this.height,"px"),"background-image":"radial-gradient(circle at center, rgba(255,255,255, 0.7) 0%, rgba(255,255,255,0.1) 100%)",transform:"translate(".concat(this.hoverX-this.width/2,"px, ").concat(this.hoverY-this.height/2,"px) translate(-").concat(this.width/2,"px, -").concat(this.height/2,"px)"),opacity:this.isHover?this.hoverGlareOpacity:0,"transform-style":"preserve-3d"}},clickGlareStyle:function(){var t=this.clickGlareSize*this.glareScale,e=(t-this.clickGlareSize)/2,i=this.clickGlareTop-this.clickGlareSize/2,o=this.clickGlareLeft-this.clickGlareSize/2;return{position:"absolute",width:"".concat(this.clickGlareSize,"px"),height:"".concat(this.clickGlareSize,"px"),opacity:0,"border-radius":"50%","--glare-top":"".concat(i,"px"),"--glare-left":"".concat(o,"px"),"--glare-opacity":"".concat(this.clickGlareOpacity),"--glare-scaled-size":"".concat(t,"px"),"--glare-scaled-top":"".concat(i-e,"px"),"--glare-scaled-left":"".concat(o-e,"px"),"transform-style":"preserve-3d"}},frontFaceStyle:function(){return s({},this.faceStyle,{},this.frontStyle,{position:"absolute",width:"".concat(this.width,"px"),height:"".concat(this.height,"px"),transform:"translateZ(".concat(this.height/2,"px)"),outline:"1px solid transparent"})},backFaceStyle:function(){return s({},this.faceStyle,{},this.backStyle,{position:"absolute",width:"".concat(this.width,"px"),height:"".concat(this.height,"px"),transform:"translateZ(-".concat(this.height/2,"px) rotateZ(180deg) rotateY(180deg)"),outline:"1px solid transparent"})},topFaceStyle:function(){return s({},this.faceStyle,{},this.topStyle,{position:"absolute",width:"".concat(this.width,"px"),height:"".concat(this.height,"px"),transform:"translateY(-".concat(this.height/2,"px) rotateX(90deg)"),outline:"1px solid transparent"})},bottomFaceStyle:function(){return s({},this.faceStyle,{},this.bottomStyle,{position:"absolute",width:"".concat(this.width,"px"),height:"".concat(this.height,"px"),transform:"translateY(".concat(this.height-this.height/2,"px) rotateX(-90deg)"),outline:"1px solid transparent"})},leftFaceStyle:function(){return s({},this.faceStyle,{},this.leftStyle,{position:"absolute",width:"".concat(this.height,"px"),height:"".concat(this.height,"px"),transform:"translateX(-".concat(this.height/2,"px) rotateY(-90deg)"),outline:"1px solid transparent"})},rightFaceStyle:function(){return s({},this.faceStyle,{},this.rightStyle,{position:"absolute",width:"".concat(this.height,"px"),height:"".concat(this.height,"px"),transform:"translateX(".concat(this.width-this.height/2,"px) rotateY(90deg)"),outline:"1px solid transparent"})}},methods:{getRelativePos2Scene:function(t,e){var i=this.$refs.scene.getBoundingClientRect();return{x:t-(i.left+window.scrollX),y:e-(i.top+window.scrollY)}},onMouseDown:function(t){var e=this.getRelativePos2Scene(t.pageX,t.pageY);this.mouseDownX=t.pageX,this.mouseDownY=t.pageY,this.tiltTile(e),this.clickGlare(e),this.setMouseDown(!0)},onMouseUp:function(t){this.mouseDownX===t.pageX&&this.mouseDownY===t.pageY&&this.$emit("click",t),this.recoverTile(),this.setMouseDown(!1)},onMouseMove:function(t){var e=this.getRelativePos2Scene(t.pageX,t.pageY);this.hoverGlare(e)},onMouseLeave:function(){this.recoverTile(),this.resetHover()},onTouchMove:function(t){this.$emit("touchmove",t)},tiltTile:function(t){var e=t.x/this.width,i=t.y/this.height,o=((.5-i)*this.maxTiltX).toFixed(2),n=((e-.5)*this.maxTiltY).toFixed(2);this.curTiltTransform="rotateX(".concat(o,"deg) rotateY(").concat(n,"deg)")},recoverTile:function(){this.curTiltTransform=""},resetHover:function(){this.isHover=!1},clickGlare:function(t){this.clickGlareTop=t.y,this.clickGlareLeft=t.x,this.isAnimating=!0},resetAnimation:function(){this.isAnimating=!1},hoverGlare:function(t){this.isHover=!0,this.hoverX=t.x,this.hoverY=t.y},setMouseDown:function(t){this.isMouseDown=t}}},l=c,u=(i("ccb7"),i("2877")),_=Object(u["a"])(l,o,n,!1,null,null,null);e["a"]=_.exports},bd67:function(t,e,i){},ccb7:function(t,e,i){"use strict";var o=i("bd67"),n=i.n(o);n.a}});
//# sourceMappingURL=app.86e1323d.js.map